{"version":3,"sources":["../../../../../node_modules/%40langchain/core/dist/prompts/few_shot.js","../../../../../node_modules/%40langchain/core/dist/messages/index.js","../../../../../node_modules/%40langchain/core/dist/messages/transformers.js","../../../../../node_modules/%40langchain/core/dist/prompts/chat.js","../../../../../node_modules/%40langchain/core/dist/prompts/image.js","../../../../../node_modules/%40langchain/core/dist/prompts/dict.js"],"sourcesContent":["import { BaseStringPromptTemplate } from \"./string.js\";\nimport { checkValidTemplate, renderTemplate, } from \"./template.js\";\nimport { PromptTemplate } from \"./prompt.js\";\nimport { BaseChatPromptTemplate, } from \"./chat.js\";\n/**\n * Prompt template that contains few-shot examples.\n * @augments BasePromptTemplate\n * @augments FewShotPromptTemplateInput\n * @example\n * ```typescript\n * const examplePrompt = PromptTemplate.fromTemplate(\n *   \"Input: {input}\\nOutput: {output}\",\n * );\n *\n * const exampleSelector = await SemanticSimilarityExampleSelector.fromExamples(\n *   [\n *     { input: \"happy\", output: \"sad\" },\n *     { input: \"tall\", output: \"short\" },\n *     { input: \"energetic\", output: \"lethargic\" },\n *     { input: \"sunny\", output: \"gloomy\" },\n *     { input: \"windy\", output: \"calm\" },\n *   ],\n *   new OpenAIEmbeddings(),\n *   HNSWLib,\n *   { k: 1 },\n * );\n *\n * const dynamicPrompt = new FewShotPromptTemplate({\n *   exampleSelector,\n *   examplePrompt,\n *   prefix: \"Give the antonym of every input\",\n *   suffix: \"Input: {adjective}\\nOutput:\",\n *   inputVariables: [\"adjective\"],\n * });\n *\n * // Format the dynamic prompt with the input 'rainy'\n * console.log(await dynamicPrompt.format({ adjective: \"rainy\" }));\n *\n * ```\n */\nexport class FewShotPromptTemplate extends BaseStringPromptTemplate {\n    constructor(input) {\n        super(input);\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"examples\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"exampleSelector\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"examplePrompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"suffix\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\"\n        });\n        Object.defineProperty(this, \"exampleSeparator\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\\n\\n\"\n        });\n        Object.defineProperty(this, \"prefix\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\"\n        });\n        Object.defineProperty(this, \"templateFormat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"f-string\"\n        });\n        Object.defineProperty(this, \"validateTemplate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.assign(this, input);\n        if (this.examples !== undefined && this.exampleSelector !== undefined) {\n            throw new Error(\"Only one of 'examples' and 'example_selector' should be provided\");\n        }\n        if (this.examples === undefined && this.exampleSelector === undefined) {\n            throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\n        }\n        if (this.validateTemplate) {\n            let totalInputVariables = this.inputVariables;\n            if (this.partialVariables) {\n                totalInputVariables = totalInputVariables.concat(Object.keys(this.partialVariables));\n            }\n            checkValidTemplate(this.prefix + this.suffix, this.templateFormat, totalInputVariables);\n        }\n    }\n    _getPromptType() {\n        return \"few_shot\";\n    }\n    static lc_name() {\n        return \"FewShotPromptTemplate\";\n    }\n    async getExamples(inputVariables) {\n        if (this.examples !== undefined) {\n            return this.examples;\n        }\n        if (this.exampleSelector !== undefined) {\n            return this.exampleSelector.selectExamples(inputVariables);\n        }\n        throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\n    }\n    async partial(values) {\n        const newInputVariables = this.inputVariables.filter((iv) => !(iv in values));\n        const newPartialVariables = {\n            ...(this.partialVariables ?? {}),\n            ...values,\n        };\n        const promptDict = {\n            ...this,\n            inputVariables: newInputVariables,\n            partialVariables: newPartialVariables,\n        };\n        return new FewShotPromptTemplate(promptDict);\n    }\n    /**\n     * Formats the prompt with the given values.\n     * @param values The values to format the prompt with.\n     * @returns A promise that resolves to a string representing the formatted prompt.\n     */\n    async format(values) {\n        const allValues = await this.mergePartialAndUserVariables(values);\n        const examples = await this.getExamples(allValues);\n        const exampleStrings = await Promise.all(examples.map((example) => this.examplePrompt.format(example)));\n        const template = [this.prefix, ...exampleStrings, this.suffix].join(this.exampleSeparator);\n        return renderTemplate(template, this.templateFormat, allValues);\n    }\n    serialize() {\n        if (this.exampleSelector || !this.examples) {\n            throw new Error(\"Serializing an example selector is not currently supported\");\n        }\n        if (this.outputParser !== undefined) {\n            throw new Error(\"Serializing an output parser is not currently supported\");\n        }\n        return {\n            _type: this._getPromptType(),\n            input_variables: this.inputVariables,\n            example_prompt: this.examplePrompt.serialize(),\n            example_separator: this.exampleSeparator,\n            suffix: this.suffix,\n            prefix: this.prefix,\n            template_format: this.templateFormat,\n            examples: this.examples,\n        };\n    }\n    static async deserialize(data) {\n        const { example_prompt } = data;\n        if (!example_prompt) {\n            throw new Error(\"Missing example prompt\");\n        }\n        const examplePrompt = await PromptTemplate.deserialize(example_prompt);\n        let examples;\n        if (Array.isArray(data.examples)) {\n            examples = data.examples;\n        }\n        else {\n            throw new Error(\"Invalid examples format. Only list or string are supported.\");\n        }\n        return new FewShotPromptTemplate({\n            inputVariables: data.input_variables,\n            examplePrompt,\n            examples,\n            exampleSeparator: data.example_separator,\n            prefix: data.prefix,\n            suffix: data.suffix,\n            templateFormat: data.template_format,\n        });\n    }\n}\n/**\n * Chat prompt template that contains few-shot examples.\n * @augments BasePromptTemplateInput\n * @augments FewShotChatMessagePromptTemplateInput\n */\nexport class FewShotChatMessagePromptTemplate extends BaseChatPromptTemplate {\n    _getPromptType() {\n        return \"few_shot_chat\";\n    }\n    static lc_name() {\n        return \"FewShotChatMessagePromptTemplate\";\n    }\n    constructor(fields) {\n        super(fields);\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"examples\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"exampleSelector\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"examplePrompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"suffix\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\"\n        });\n        Object.defineProperty(this, \"exampleSeparator\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\\n\\n\"\n        });\n        Object.defineProperty(this, \"prefix\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"\"\n        });\n        Object.defineProperty(this, \"templateFormat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"f-string\"\n        });\n        Object.defineProperty(this, \"validateTemplate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        this.examples = fields.examples;\n        this.examplePrompt = fields.examplePrompt;\n        this.exampleSeparator = fields.exampleSeparator ?? \"\\n\\n\";\n        this.exampleSelector = fields.exampleSelector;\n        this.prefix = fields.prefix ?? \"\";\n        this.suffix = fields.suffix ?? \"\";\n        this.templateFormat = fields.templateFormat ?? \"f-string\";\n        this.validateTemplate = fields.validateTemplate ?? true;\n        if (this.examples !== undefined && this.exampleSelector !== undefined) {\n            throw new Error(\"Only one of 'examples' and 'example_selector' should be provided\");\n        }\n        if (this.examples === undefined && this.exampleSelector === undefined) {\n            throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\n        }\n        if (this.validateTemplate) {\n            let totalInputVariables = this.inputVariables;\n            if (this.partialVariables) {\n                totalInputVariables = totalInputVariables.concat(Object.keys(this.partialVariables));\n            }\n            checkValidTemplate(this.prefix + this.suffix, this.templateFormat, totalInputVariables);\n        }\n    }\n    async getExamples(inputVariables) {\n        if (this.examples !== undefined) {\n            return this.examples;\n        }\n        if (this.exampleSelector !== undefined) {\n            return this.exampleSelector.selectExamples(inputVariables);\n        }\n        throw new Error(\"One of 'examples' and 'example_selector' should be provided\");\n    }\n    /**\n     * Formats the list of values and returns a list of formatted messages.\n     * @param values The values to format the prompt with.\n     * @returns A promise that resolves to a string representing the formatted prompt.\n     */\n    async formatMessages(values) {\n        const allValues = await this.mergePartialAndUserVariables(values);\n        let examples = await this.getExamples(allValues);\n        examples = examples.map((example) => {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const result = {};\n            this.examplePrompt.inputVariables.forEach((inputVariable) => {\n                result[inputVariable] = example[inputVariable];\n            });\n            return result;\n        });\n        const messages = [];\n        for (const example of examples) {\n            const exampleMessages = await this.examplePrompt.formatMessages(example);\n            messages.push(...exampleMessages);\n        }\n        return messages;\n    }\n    /**\n     * Formats the prompt with the given values.\n     * @param values The values to format the prompt with.\n     * @returns A promise that resolves to a string representing the formatted prompt.\n     */\n    async format(values) {\n        const allValues = await this.mergePartialAndUserVariables(values);\n        const examples = await this.getExamples(allValues);\n        const exampleMessages = await Promise.all(examples.map((example) => this.examplePrompt.formatMessages(example)));\n        const exampleStrings = exampleMessages\n            .flat()\n            .map((message) => message.content);\n        const template = [this.prefix, ...exampleStrings, this.suffix].join(this.exampleSeparator);\n        return renderTemplate(template, this.templateFormat, allValues);\n    }\n    /**\n     * Partially formats the prompt with the given values.\n     * @param values The values to partially format the prompt with.\n     * @returns A promise that resolves to an instance of `FewShotChatMessagePromptTemplate` with the given values partially formatted.\n     */\n    async partial(values) {\n        const newInputVariables = this.inputVariables.filter((variable) => !(variable in values));\n        const newPartialVariables = {\n            ...(this.partialVariables ?? {}),\n            ...values,\n        };\n        const promptDict = {\n            ...this,\n            inputVariables: newInputVariables,\n            partialVariables: newPartialVariables,\n        };\n        return new FewShotChatMessagePromptTemplate(promptDict);\n    }\n}\n","export * from \"./ai.js\";\nexport * from \"./base.js\";\nexport * from \"./chat.js\";\nexport * from \"./function.js\";\nexport * from \"./human.js\";\nexport * from \"./system.js\";\nexport * from \"./utils.js\";\nexport * from \"./transformers.js\";\nexport * from \"./modifier.js\";\nexport * from \"./content_blocks.js\";\n// TODO: Use a star export when we deprecate the\n// existing \"ToolCall\" type in \"base.js\".\nexport { ToolMessage, ToolMessageChunk, isToolMessage, isToolMessageChunk, } from \"./tool.js\";\n","import { RunnableLambda } from \"../runnables/base.js\";\nimport { AIMessage, AIMessageChunk } from \"./ai.js\";\nimport { isBaseMessageChunk, } from \"./base.js\";\nimport { ChatMessage, ChatMessageChunk, } from \"./chat.js\";\nimport { FunctionMessage, FunctionMessageChunk, } from \"./function.js\";\nimport { HumanMessage, HumanMessageChunk } from \"./human.js\";\nimport { RemoveMessage } from \"./modifier.js\";\nimport { SystemMessage, SystemMessageChunk } from \"./system.js\";\nimport { ToolMessage, ToolMessageChunk, } from \"./tool.js\";\nimport { convertToChunk } from \"./utils.js\";\nconst _isMessageType = (msg, types) => {\n    const typesAsStrings = [\n        ...new Set(types?.map((t) => {\n            if (typeof t === \"string\") {\n                return t;\n            }\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const instantiatedMsgClass = new t({});\n            if (!(\"getType\" in instantiatedMsgClass) ||\n                typeof instantiatedMsgClass.getType !== \"function\") {\n                throw new Error(\"Invalid type provided.\");\n            }\n            return instantiatedMsgClass.getType();\n        })),\n    ];\n    const msgType = msg.getType();\n    return typesAsStrings.some((t) => t === msgType);\n};\nexport function filterMessages(messagesOrOptions, options) {\n    if (Array.isArray(messagesOrOptions)) {\n        return _filterMessages(messagesOrOptions, options);\n    }\n    return RunnableLambda.from((input) => {\n        return _filterMessages(input, messagesOrOptions);\n    });\n}\nfunction _filterMessages(messages, options = {}) {\n    const { includeNames, excludeNames, includeTypes, excludeTypes, includeIds, excludeIds, } = options;\n    const filtered = [];\n    for (const msg of messages) {\n        if (excludeNames && msg.name && excludeNames.includes(msg.name)) {\n            continue;\n        }\n        else if (excludeTypes && _isMessageType(msg, excludeTypes)) {\n            continue;\n        }\n        else if (excludeIds && msg.id && excludeIds.includes(msg.id)) {\n            continue;\n        }\n        // default to inclusion when no inclusion criteria given.\n        if (!(includeTypes || includeIds || includeNames)) {\n            filtered.push(msg);\n        }\n        else if (includeNames &&\n            msg.name &&\n            includeNames.some((iName) => iName === msg.name)) {\n            filtered.push(msg);\n        }\n        else if (includeTypes && _isMessageType(msg, includeTypes)) {\n            filtered.push(msg);\n        }\n        else if (includeIds && msg.id && includeIds.some((id) => id === msg.id)) {\n            filtered.push(msg);\n        }\n    }\n    return filtered;\n}\nexport function mergeMessageRuns(messages) {\n    if (Array.isArray(messages)) {\n        return _mergeMessageRuns(messages);\n    }\n    return RunnableLambda.from(_mergeMessageRuns);\n}\nfunction _mergeMessageRuns(messages) {\n    if (!messages.length) {\n        return [];\n    }\n    const merged = [];\n    for (const msg of messages) {\n        const curr = msg;\n        const last = merged.pop();\n        if (!last) {\n            merged.push(curr);\n        }\n        else if (curr.getType() === \"tool\" ||\n            !(curr.getType() === last.getType())) {\n            merged.push(last, curr);\n        }\n        else {\n            const lastChunk = convertToChunk(last);\n            const currChunk = convertToChunk(curr);\n            const mergedChunks = lastChunk.concat(currChunk);\n            if (typeof lastChunk.content === \"string\" &&\n                typeof currChunk.content === \"string\") {\n                mergedChunks.content = `${lastChunk.content}\\n${currChunk.content}`;\n            }\n            merged.push(_chunkToMsg(mergedChunks));\n        }\n    }\n    return merged;\n}\nexport function trimMessages(messagesOrOptions, options) {\n    if (Array.isArray(messagesOrOptions)) {\n        const messages = messagesOrOptions;\n        if (!options) {\n            throw new Error(\"Options parameter is required when providing messages.\");\n        }\n        return _trimMessagesHelper(messages, options);\n    }\n    else {\n        const trimmerOptions = messagesOrOptions;\n        return RunnableLambda.from((input) => _trimMessagesHelper(input, trimmerOptions)).withConfig({\n            runName: \"trim_messages\",\n        });\n    }\n}\nasync function _trimMessagesHelper(messages, options) {\n    const { maxTokens, tokenCounter, strategy = \"last\", allowPartial = false, endOn, startOn, includeSystem = false, textSplitter, } = options;\n    if (startOn && strategy === \"first\") {\n        throw new Error(\"`startOn` should only be specified if `strategy` is 'last'.\");\n    }\n    if (includeSystem && strategy === \"first\") {\n        throw new Error(\"`includeSystem` should only be specified if `strategy` is 'last'.\");\n    }\n    let listTokenCounter;\n    if (\"getNumTokens\" in tokenCounter) {\n        listTokenCounter = async (msgs) => {\n            const tokenCounts = await Promise.all(msgs.map((msg) => tokenCounter.getNumTokens(msg.content)));\n            return tokenCounts.reduce((sum, count) => sum + count, 0);\n        };\n    }\n    else {\n        listTokenCounter = async (msgs) => tokenCounter(msgs);\n    }\n    let textSplitterFunc = defaultTextSplitter;\n    if (textSplitter) {\n        if (\"splitText\" in textSplitter) {\n            textSplitterFunc = textSplitter.splitText;\n        }\n        else {\n            textSplitterFunc = async (text) => textSplitter(text);\n        }\n    }\n    if (strategy === \"first\") {\n        return _firstMaxTokens(messages, {\n            maxTokens,\n            tokenCounter: listTokenCounter,\n            textSplitter: textSplitterFunc,\n            partialStrategy: allowPartial ? \"first\" : undefined,\n            endOn,\n        });\n    }\n    else if (strategy === \"last\") {\n        return _lastMaxTokens(messages, {\n            maxTokens,\n            tokenCounter: listTokenCounter,\n            textSplitter: textSplitterFunc,\n            allowPartial,\n            includeSystem,\n            startOn,\n            endOn,\n        });\n    }\n    else {\n        throw new Error(`Unrecognized strategy: '${strategy}'. Must be one of 'first' or 'last'.`);\n    }\n}\nasync function _firstMaxTokens(messages, options) {\n    const { maxTokens, tokenCounter, textSplitter, partialStrategy, endOn } = options;\n    let messagesCopy = [...messages];\n    let idx = 0;\n    for (let i = 0; i < messagesCopy.length; i += 1) {\n        const remainingMessages = i > 0 ? messagesCopy.slice(0, -i) : messagesCopy;\n        if ((await tokenCounter(remainingMessages)) <= maxTokens) {\n            idx = messagesCopy.length - i;\n            break;\n        }\n    }\n    if (idx < messagesCopy.length && partialStrategy) {\n        let includedPartial = false;\n        if (Array.isArray(messagesCopy[idx].content)) {\n            const excluded = messagesCopy[idx];\n            if (typeof excluded.content === \"string\") {\n                throw new Error(\"Expected content to be an array.\");\n            }\n            const numBlock = excluded.content.length;\n            const reversedContent = partialStrategy === \"last\"\n                ? [...excluded.content].reverse()\n                : excluded.content;\n            for (let i = 1; i <= numBlock; i += 1) {\n                const partialContent = partialStrategy === \"first\"\n                    ? reversedContent.slice(0, i)\n                    : reversedContent.slice(-i);\n                const fields = Object.fromEntries(Object.entries(excluded).filter(([k]) => k !== \"type\" && !k.startsWith(\"lc_\")));\n                const updatedMessage = _switchTypeToMessage(excluded.getType(), {\n                    ...fields,\n                    content: partialContent,\n                });\n                const slicedMessages = [...messagesCopy.slice(0, idx), updatedMessage];\n                if ((await tokenCounter(slicedMessages)) <= maxTokens) {\n                    messagesCopy = slicedMessages;\n                    idx += 1;\n                    includedPartial = true;\n                }\n                else {\n                    break;\n                }\n            }\n            if (includedPartial && partialStrategy === \"last\") {\n                excluded.content = [...reversedContent].reverse();\n            }\n        }\n        if (!includedPartial) {\n            const excluded = messagesCopy[idx];\n            let text;\n            if (Array.isArray(excluded.content) &&\n                excluded.content.some((block) => typeof block === \"string\" || block.type === \"text\")) {\n                const textBlock = excluded.content.find((block) => block.type === \"text\" && block.text);\n                text = textBlock?.text;\n            }\n            else if (typeof excluded.content === \"string\") {\n                text = excluded.content;\n            }\n            if (text) {\n                const splitTexts = await textSplitter(text);\n                const numSplits = splitTexts.length;\n                if (partialStrategy === \"last\") {\n                    splitTexts.reverse();\n                }\n                for (let _ = 0; _ < numSplits - 1; _ += 1) {\n                    splitTexts.pop();\n                    excluded.content = splitTexts.join(\"\");\n                    if ((await tokenCounter([...messagesCopy.slice(0, idx), excluded])) <=\n                        maxTokens) {\n                        if (partialStrategy === \"last\") {\n                            excluded.content = [...splitTexts].reverse().join(\"\");\n                        }\n                        messagesCopy = [...messagesCopy.slice(0, idx), excluded];\n                        idx += 1;\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    if (endOn) {\n        const endOnArr = Array.isArray(endOn) ? endOn : [endOn];\n        while (idx > 0 && !_isMessageType(messagesCopy[idx - 1], endOnArr)) {\n            idx -= 1;\n        }\n    }\n    return messagesCopy.slice(0, idx);\n}\nasync function _lastMaxTokens(messages, options) {\n    const { allowPartial = false, includeSystem = false, endOn, startOn, ...rest } = options;\n    // Create a copy of messages to avoid mutation\n    let messagesCopy = messages.map((message) => {\n        const fields = Object.fromEntries(Object.entries(message).filter(([k]) => k !== \"type\" && !k.startsWith(\"lc_\")));\n        return _switchTypeToMessage(message.getType(), fields, isBaseMessageChunk(message));\n    });\n    if (endOn) {\n        const endOnArr = Array.isArray(endOn) ? endOn : [endOn];\n        while (messagesCopy.length > 0 &&\n            !_isMessageType(messagesCopy[messagesCopy.length - 1], endOnArr)) {\n            messagesCopy = messagesCopy.slice(0, -1);\n        }\n    }\n    const swappedSystem = includeSystem && messagesCopy[0]?.getType() === \"system\";\n    let reversed_ = swappedSystem\n        ? messagesCopy.slice(0, 1).concat(messagesCopy.slice(1).reverse())\n        : messagesCopy.reverse();\n    reversed_ = await _firstMaxTokens(reversed_, {\n        ...rest,\n        partialStrategy: allowPartial ? \"last\" : undefined,\n        endOn: startOn,\n    });\n    if (swappedSystem) {\n        return [reversed_[0], ...reversed_.slice(1).reverse()];\n    }\n    else {\n        return reversed_.reverse();\n    }\n}\nconst _MSG_CHUNK_MAP = {\n    human: {\n        message: HumanMessage,\n        messageChunk: HumanMessageChunk,\n    },\n    ai: {\n        message: AIMessage,\n        messageChunk: AIMessageChunk,\n    },\n    system: {\n        message: SystemMessage,\n        messageChunk: SystemMessageChunk,\n    },\n    developer: {\n        message: SystemMessage,\n        messageChunk: SystemMessageChunk,\n    },\n    tool: {\n        message: ToolMessage,\n        messageChunk: ToolMessageChunk,\n    },\n    function: {\n        message: FunctionMessage,\n        messageChunk: FunctionMessageChunk,\n    },\n    generic: {\n        message: ChatMessage,\n        messageChunk: ChatMessageChunk,\n    },\n    remove: {\n        message: RemoveMessage,\n        messageChunk: RemoveMessage, // RemoveMessage does not have a chunk class.\n    },\n};\nfunction _switchTypeToMessage(messageType, fields, returnChunk) {\n    let chunk;\n    let msg;\n    switch (messageType) {\n        case \"human\":\n            if (returnChunk) {\n                chunk = new HumanMessageChunk(fields);\n            }\n            else {\n                msg = new HumanMessage(fields);\n            }\n            break;\n        case \"ai\":\n            if (returnChunk) {\n                let aiChunkFields = {\n                    ...fields,\n                };\n                if (\"tool_calls\" in aiChunkFields) {\n                    aiChunkFields = {\n                        ...aiChunkFields,\n                        tool_call_chunks: aiChunkFields.tool_calls?.map((tc) => ({\n                            ...tc,\n                            type: \"tool_call_chunk\",\n                            index: undefined,\n                            args: JSON.stringify(tc.args),\n                        })),\n                    };\n                }\n                chunk = new AIMessageChunk(aiChunkFields);\n            }\n            else {\n                msg = new AIMessage(fields);\n            }\n            break;\n        case \"system\":\n            if (returnChunk) {\n                chunk = new SystemMessageChunk(fields);\n            }\n            else {\n                msg = new SystemMessage(fields);\n            }\n            break;\n        case \"developer\":\n            if (returnChunk) {\n                chunk = new SystemMessageChunk({\n                    ...fields,\n                    additional_kwargs: {\n                        ...fields.additional_kwargs,\n                        __openai_role__: \"developer\",\n                    },\n                });\n            }\n            else {\n                msg = new SystemMessage({\n                    ...fields,\n                    additional_kwargs: {\n                        ...fields.additional_kwargs,\n                        __openai_role__: \"developer\",\n                    },\n                });\n            }\n            break;\n        case \"tool\":\n            if (\"tool_call_id\" in fields) {\n                if (returnChunk) {\n                    chunk = new ToolMessageChunk(fields);\n                }\n                else {\n                    msg = new ToolMessage(fields);\n                }\n            }\n            else {\n                throw new Error(\"Can not convert ToolMessage to ToolMessageChunk if 'tool_call_id' field is not defined.\");\n            }\n            break;\n        case \"function\":\n            if (returnChunk) {\n                chunk = new FunctionMessageChunk(fields);\n            }\n            else {\n                if (!fields.name) {\n                    throw new Error(\"FunctionMessage must have a 'name' field\");\n                }\n                msg = new FunctionMessage(fields);\n            }\n            break;\n        case \"generic\":\n            if (\"role\" in fields) {\n                if (returnChunk) {\n                    chunk = new ChatMessageChunk(fields);\n                }\n                else {\n                    msg = new ChatMessage(fields);\n                }\n            }\n            else {\n                throw new Error(\"Can not convert ChatMessage to ChatMessageChunk if 'role' field is not defined.\");\n            }\n            break;\n        default:\n            throw new Error(`Unrecognized message type ${messageType}`);\n    }\n    if (returnChunk && chunk) {\n        return chunk;\n    }\n    if (msg) {\n        return msg;\n    }\n    throw new Error(`Unrecognized message type ${messageType}`);\n}\nfunction _chunkToMsg(chunk) {\n    const chunkType = chunk.getType();\n    let msg;\n    const fields = Object.fromEntries(Object.entries(chunk).filter(([k]) => ![\"type\", \"tool_call_chunks\"].includes(k) && !k.startsWith(\"lc_\")));\n    if (chunkType in _MSG_CHUNK_MAP) {\n        msg = _switchTypeToMessage(chunkType, fields);\n    }\n    if (!msg) {\n        throw new Error(`Unrecognized message chunk class ${chunkType}. Supported classes are ${Object.keys(_MSG_CHUNK_MAP)}`);\n    }\n    return msg;\n}\n/**\n * The default text splitter function that splits text by newlines.\n *\n * @param {string} text\n * @returns A promise that resolves to an array of strings split by newlines.\n */\nexport function defaultTextSplitter(text) {\n    const splits = text.split(\"\\n\");\n    return Promise.resolve([\n        ...splits.slice(0, -1).map((s) => `${s}\\n`),\n        splits[splits.length - 1],\n    ]);\n}\n","// Default generic \"any\" values are for backwards compatibility.\n// Replace with \"string\" when we are comfortable with a breaking change.\nimport { AIMessage, HumanMessage, SystemMessage, BaseMessage, ChatMessage, coerceMessageLikeToMessage, isBaseMessage, } from \"../messages/index.js\";\nimport { ChatPromptValue, } from \"../prompt_values.js\";\nimport { Runnable } from \"../runnables/base.js\";\nimport { BaseStringPromptTemplate } from \"./string.js\";\nimport { BasePromptTemplate, } from \"./base.js\";\nimport { PromptTemplate, } from \"./prompt.js\";\nimport { ImagePromptTemplate } from \"./image.js\";\nimport { parseFString, parseMustache, } from \"./template.js\";\nimport { addLangChainErrorFields } from \"../errors/index.js\";\nimport { DictPromptTemplate } from \"./dict.js\";\n/**\n * Abstract class that serves as a base for creating message prompt\n * templates. It defines how to format messages for different roles in a\n * conversation.\n */\nexport class BaseMessagePromptTemplate extends Runnable {\n    constructor() {\n        super(...arguments);\n        Object.defineProperty(this, \"lc_namespace\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: [\"langchain_core\", \"prompts\", \"chat\"]\n        });\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n    }\n    /**\n     * Calls the formatMessages method with the provided input and options.\n     * @param input Input for the formatMessages method\n     * @param options Optional BaseCallbackConfig\n     * @returns Formatted output messages\n     */\n    async invoke(input, options) {\n        return this._callWithConfig((input) => this.formatMessages(input), input, { ...options, runType: \"prompt\" });\n    }\n}\n/**\n * Class that represents a placeholder for messages in a chat prompt. It\n * extends the BaseMessagePromptTemplate.\n */\nexport class MessagesPlaceholder extends BaseMessagePromptTemplate {\n    static lc_name() {\n        return \"MessagesPlaceholder\";\n    }\n    constructor(fields) {\n        if (typeof fields === \"string\") {\n            // eslint-disable-next-line no-param-reassign\n            fields = { variableName: fields };\n        }\n        super(fields);\n        Object.defineProperty(this, \"variableName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"optional\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.variableName = fields.variableName;\n        this.optional = fields.optional ?? false;\n    }\n    get inputVariables() {\n        return [this.variableName];\n    }\n    async formatMessages(values) {\n        const input = values[this.variableName];\n        if (this.optional && !input) {\n            return [];\n        }\n        else if (!input) {\n            const error = new Error(`Field \"${this.variableName}\" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);\n            error.name = \"InputFormatError\";\n            throw error;\n        }\n        let formattedMessages;\n        try {\n            if (Array.isArray(input)) {\n                formattedMessages = input.map(coerceMessageLikeToMessage);\n            }\n            else {\n                formattedMessages = [coerceMessageLikeToMessage(input)];\n            }\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        }\n        catch (e) {\n            const readableInput = typeof input === \"string\" ? input : JSON.stringify(input, null, 2);\n            const error = new Error([\n                `Field \"${this.variableName}\" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,\n                `Received value: ${readableInput}`,\n                `Additional message: ${e.message}`,\n            ].join(\"\\n\\n\"));\n            error.name = \"InputFormatError\";\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            error.lc_error_code = e.lc_error_code;\n            throw error;\n        }\n        return formattedMessages;\n    }\n}\n/**\n * Abstract class that serves as a base for creating message string prompt\n * templates. It extends the BaseMessagePromptTemplate.\n */\nexport class BaseMessageStringPromptTemplate extends BaseMessagePromptTemplate {\n    constructor(fields) {\n        if (!(\"prompt\" in fields)) {\n            // eslint-disable-next-line no-param-reassign\n            fields = { prompt: fields };\n        }\n        super(fields);\n        Object.defineProperty(this, \"prompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.prompt = fields.prompt;\n    }\n    get inputVariables() {\n        return this.prompt.inputVariables;\n    }\n    async formatMessages(values) {\n        return [await this.format(values)];\n    }\n}\n/**\n * Abstract class that serves as a base for creating chat prompt\n * templates. It extends the BasePromptTemplate.\n */\nexport class BaseChatPromptTemplate extends BasePromptTemplate {\n    constructor(input) {\n        super(input);\n    }\n    async format(values) {\n        return (await this.formatPromptValue(values)).toString();\n    }\n    async formatPromptValue(values) {\n        const resultMessages = await this.formatMessages(values);\n        return new ChatPromptValue(resultMessages);\n    }\n}\n/**\n * Class that represents a chat message prompt template. It extends the\n * BaseMessageStringPromptTemplate.\n */\nexport class ChatMessagePromptTemplate extends BaseMessageStringPromptTemplate {\n    static lc_name() {\n        return \"ChatMessagePromptTemplate\";\n    }\n    constructor(fields, role) {\n        if (!(\"prompt\" in fields)) {\n            // eslint-disable-next-line no-param-reassign, @typescript-eslint/no-non-null-assertion\n            fields = { prompt: fields, role: role };\n        }\n        super(fields);\n        Object.defineProperty(this, \"role\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.role = fields.role;\n    }\n    async format(values) {\n        return new ChatMessage(await this.prompt.format(values), this.role);\n    }\n    static fromTemplate(template, role, options) {\n        return new this(PromptTemplate.fromTemplate(template, {\n            templateFormat: options?.templateFormat,\n        }), role);\n    }\n}\nfunction isTextTemplateParam(param) {\n    if (param === null || typeof param !== \"object\" || Array.isArray(param)) {\n        return false;\n    }\n    return (Object.keys(param).length === 1 &&\n        \"text\" in param &&\n        typeof param.text === \"string\");\n}\nfunction isImageTemplateParam(param) {\n    if (param === null || typeof param !== \"object\" || Array.isArray(param)) {\n        return false;\n    }\n    return (\"image_url\" in param &&\n        (typeof param.image_url === \"string\" ||\n            (typeof param.image_url === \"object\" &&\n                param.image_url !== null &&\n                \"url\" in param.image_url &&\n                typeof param.image_url.url === \"string\")));\n}\nclass _StringImageMessagePromptTemplate extends BaseMessagePromptTemplate {\n    static _messageClass() {\n        throw new Error(\"Can not invoke _messageClass from inside _StringImageMessagePromptTemplate\");\n    }\n    constructor(\n    /** @TODO When we come up with a better way to type prompt templates, fix this */\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    fields, additionalOptions) {\n        if (!(\"prompt\" in fields)) {\n            // eslint-disable-next-line no-param-reassign\n            fields = { prompt: fields };\n        }\n        super(fields);\n        Object.defineProperty(this, \"lc_namespace\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: [\"langchain_core\", \"prompts\", \"chat\"]\n        });\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"inputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"additionalOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"prompt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"messageClass\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // ChatMessage contains role field, others don't.\n        // Because of this, we have a separate class property for ChatMessage.\n        Object.defineProperty(this, \"chatMessageClass\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.prompt = fields.prompt;\n        if (Array.isArray(this.prompt)) {\n            let inputVariables = [];\n            this.prompt.forEach((prompt) => {\n                if (\"inputVariables\" in prompt) {\n                    inputVariables = inputVariables.concat(prompt.inputVariables);\n                }\n            });\n            this.inputVariables = inputVariables;\n        }\n        else {\n            this.inputVariables = this.prompt.inputVariables;\n        }\n        this.additionalOptions = additionalOptions ?? this.additionalOptions;\n    }\n    createMessage(content) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const constructor = this.constructor;\n        if (constructor._messageClass()) {\n            const MsgClass = constructor._messageClass();\n            return new MsgClass({ content });\n        }\n        else if (constructor.chatMessageClass) {\n            const MsgClass = constructor.chatMessageClass();\n            // Assuming ChatMessage constructor also takes a content argument\n            return new MsgClass({\n                content,\n                role: this.getRoleFromMessageClass(MsgClass.lc_name()),\n            });\n        }\n        else {\n            throw new Error(\"No message class defined\");\n        }\n    }\n    getRoleFromMessageClass(name) {\n        switch (name) {\n            case \"HumanMessage\":\n                return \"human\";\n            case \"AIMessage\":\n                return \"ai\";\n            case \"SystemMessage\":\n                return \"system\";\n            case \"ChatMessage\":\n                return \"chat\";\n            default:\n                throw new Error(\"Invalid message class name\");\n        }\n    }\n    static fromTemplate(template, additionalOptions) {\n        if (typeof template === \"string\") {\n            return new this(PromptTemplate.fromTemplate(template, additionalOptions));\n        }\n        const prompt = [];\n        for (const item of template) {\n            // handle string cases\n            if (typeof item === \"string\") {\n                prompt.push(PromptTemplate.fromTemplate(item, additionalOptions));\n            }\n            else if (item === null) {\n                // pass\n            }\n            else if (isTextTemplateParam(item)) {\n                let text = \"\";\n                if (typeof item.text === \"string\") {\n                    text = item.text ?? \"\";\n                }\n                const options = {\n                    ...additionalOptions,\n                    additionalContentFields: item,\n                };\n                prompt.push(PromptTemplate.fromTemplate(text, options));\n            }\n            else if (isImageTemplateParam(item)) {\n                let imgTemplate = item.image_url ?? \"\";\n                let imgTemplateObject;\n                let inputVariables = [];\n                if (typeof imgTemplate === \"string\") {\n                    let parsedTemplate;\n                    if (additionalOptions?.templateFormat === \"mustache\") {\n                        parsedTemplate = parseMustache(imgTemplate);\n                    }\n                    else {\n                        parsedTemplate = parseFString(imgTemplate);\n                    }\n                    const variables = parsedTemplate.flatMap((item) => item.type === \"variable\" ? [item.name] : []);\n                    if ((variables?.length ?? 0) > 0) {\n                        if (variables.length > 1) {\n                            throw new Error(`Only one format variable allowed per image template.\\nGot: ${variables}\\nFrom: ${imgTemplate}`);\n                        }\n                        inputVariables = [variables[0]];\n                    }\n                    else {\n                        inputVariables = [];\n                    }\n                    imgTemplate = { url: imgTemplate };\n                    imgTemplateObject = new ImagePromptTemplate({\n                        template: imgTemplate,\n                        inputVariables,\n                        templateFormat: additionalOptions?.templateFormat,\n                        additionalContentFields: item,\n                    });\n                }\n                else if (typeof imgTemplate === \"object\") {\n                    if (\"url\" in imgTemplate) {\n                        let parsedTemplate;\n                        if (additionalOptions?.templateFormat === \"mustache\") {\n                            parsedTemplate = parseMustache(imgTemplate.url);\n                        }\n                        else {\n                            parsedTemplate = parseFString(imgTemplate.url);\n                        }\n                        inputVariables = parsedTemplate.flatMap((item) => item.type === \"variable\" ? [item.name] : []);\n                    }\n                    else {\n                        inputVariables = [];\n                    }\n                    imgTemplateObject = new ImagePromptTemplate({\n                        template: imgTemplate,\n                        inputVariables,\n                        templateFormat: additionalOptions?.templateFormat,\n                        additionalContentFields: item,\n                    });\n                }\n                else {\n                    throw new Error(\"Invalid image template\");\n                }\n                prompt.push(imgTemplateObject);\n            }\n            else if (typeof item === \"object\") {\n                prompt.push(new DictPromptTemplate({\n                    template: item,\n                    templateFormat: additionalOptions?.templateFormat,\n                }));\n            }\n        }\n        return new this({ prompt, additionalOptions });\n    }\n    async format(input) {\n        // eslint-disable-next-line no-instanceof/no-instanceof\n        if (this.prompt instanceof BaseStringPromptTemplate) {\n            const text = await this.prompt.format(input);\n            return this.createMessage(text);\n        }\n        else {\n            const content = [];\n            for (const prompt of this.prompt) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                let inputs = {};\n                if (!(\"inputVariables\" in prompt)) {\n                    throw new Error(`Prompt ${prompt} does not have inputVariables defined.`);\n                }\n                for (const item of prompt.inputVariables) {\n                    if (!inputs) {\n                        inputs = { [item]: input[item] };\n                    }\n                    inputs = { ...inputs, [item]: input[item] };\n                }\n                // eslint-disable-next-line no-instanceof/no-instanceof\n                if (prompt instanceof BaseStringPromptTemplate) {\n                    const formatted = await prompt.format(inputs);\n                    let additionalContentFields;\n                    if (\"additionalContentFields\" in prompt) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        additionalContentFields = prompt.additionalContentFields;\n                    }\n                    if (formatted !== \"\") {\n                        content.push({\n                            ...additionalContentFields,\n                            type: \"text\",\n                            text: formatted,\n                        });\n                    }\n                    /** @TODO replace this */\n                    // eslint-disable-next-line no-instanceof/no-instanceof\n                }\n                else if (prompt instanceof ImagePromptTemplate) {\n                    const formatted = await prompt.format(inputs);\n                    let additionalContentFields;\n                    if (\"additionalContentFields\" in prompt) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        additionalContentFields = prompt.additionalContentFields;\n                    }\n                    content.push({\n                        ...additionalContentFields,\n                        type: \"image_url\",\n                        image_url: formatted,\n                    });\n                    // eslint-disable-next-line no-instanceof/no-instanceof\n                }\n                else if (prompt instanceof DictPromptTemplate) {\n                    const formatted = await prompt.format(inputs);\n                    let additionalContentFields;\n                    if (\"additionalContentFields\" in prompt) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        additionalContentFields = prompt.additionalContentFields;\n                    }\n                    content.push({\n                        ...additionalContentFields,\n                        ...formatted,\n                    });\n                }\n            }\n            return this.createMessage(content);\n        }\n    }\n    async formatMessages(values) {\n        return [await this.format(values)];\n    }\n}\n/**\n * Class that represents a human message prompt template. It extends the\n * BaseMessageStringPromptTemplate.\n * @example\n * ```typescript\n * const message = HumanMessagePromptTemplate.fromTemplate(\"{text}\");\n * const formatted = await message.format({ text: \"Hello world!\" });\n *\n * const chatPrompt = ChatPromptTemplate.fromMessages([message]);\n * const formattedChatPrompt = await chatPrompt.invoke({\n *   text: \"Hello world!\",\n * });\n * ```\n */\nexport class HumanMessagePromptTemplate extends _StringImageMessagePromptTemplate {\n    static _messageClass() {\n        return HumanMessage;\n    }\n    static lc_name() {\n        return \"HumanMessagePromptTemplate\";\n    }\n}\n/**\n * Class that represents an AI message prompt template. It extends the\n * BaseMessageStringPromptTemplate.\n */\nexport class AIMessagePromptTemplate extends _StringImageMessagePromptTemplate {\n    static _messageClass() {\n        return AIMessage;\n    }\n    static lc_name() {\n        return \"AIMessagePromptTemplate\";\n    }\n}\n/**\n * Class that represents a system message prompt template. It extends the\n * BaseMessageStringPromptTemplate.\n * @example\n * ```typescript\n * const message = SystemMessagePromptTemplate.fromTemplate(\"{text}\");\n * const formatted = await message.format({ text: \"Hello world!\" });\n *\n * const chatPrompt = ChatPromptTemplate.fromMessages([message]);\n * const formattedChatPrompt = await chatPrompt.invoke({\n *   text: \"Hello world!\",\n * });\n * ```\n */\nexport class SystemMessagePromptTemplate extends _StringImageMessagePromptTemplate {\n    static _messageClass() {\n        return SystemMessage;\n    }\n    static lc_name() {\n        return \"SystemMessagePromptTemplate\";\n    }\n}\nfunction _isBaseMessagePromptTemplate(baseMessagePromptTemplateLike) {\n    return (typeof baseMessagePromptTemplateLike\n        .formatMessages === \"function\");\n}\nfunction _coerceMessagePromptTemplateLike(messagePromptTemplateLike, extra) {\n    if (_isBaseMessagePromptTemplate(messagePromptTemplateLike) ||\n        isBaseMessage(messagePromptTemplateLike)) {\n        return messagePromptTemplateLike;\n    }\n    if (Array.isArray(messagePromptTemplateLike) &&\n        messagePromptTemplateLike[0] === \"placeholder\") {\n        const messageContent = messagePromptTemplateLike[1];\n        if (extra?.templateFormat === \"mustache\" &&\n            typeof messageContent === \"string\" &&\n            messageContent.slice(0, 2) === \"{{\" &&\n            messageContent.slice(-2) === \"}}\") {\n            const variableName = messageContent.slice(2, -2);\n            return new MessagesPlaceholder({ variableName, optional: true });\n        }\n        else if (typeof messageContent === \"string\" &&\n            messageContent[0] === \"{\" &&\n            messageContent[messageContent.length - 1] === \"}\") {\n            const variableName = messageContent.slice(1, -1);\n            return new MessagesPlaceholder({ variableName, optional: true });\n        }\n        throw new Error(`Invalid placeholder template for format ${extra?.templateFormat ?? `\"f-string\"`}: \"${messagePromptTemplateLike[1]}\". Expected a variable name surrounded by ${extra?.templateFormat === \"mustache\" ? \"double\" : \"single\"} curly braces.`);\n    }\n    const message = coerceMessageLikeToMessage(messagePromptTemplateLike);\n    let templateData;\n    if (typeof message.content === \"string\") {\n        templateData = message.content;\n    }\n    else {\n        // Assuming message.content is an array of complex objects, transform it.\n        templateData = message.content.map((item) => {\n            if (\"text\" in item) {\n                return { ...item, text: item.text };\n            }\n            else if (\"image_url\" in item) {\n                return { ...item, image_url: item.image_url };\n            }\n            else {\n                return item;\n            }\n        });\n    }\n    if (message._getType() === \"human\") {\n        return HumanMessagePromptTemplate.fromTemplate(templateData, extra);\n    }\n    else if (message._getType() === \"ai\") {\n        return AIMessagePromptTemplate.fromTemplate(templateData, extra);\n    }\n    else if (message._getType() === \"system\") {\n        return SystemMessagePromptTemplate.fromTemplate(templateData, extra);\n    }\n    else if (ChatMessage.isInstance(message)) {\n        return ChatMessagePromptTemplate.fromTemplate(message.content, message.role, extra);\n    }\n    else {\n        throw new Error(`Could not coerce message prompt template from input. Received message type: \"${message._getType()}\".`);\n    }\n}\nfunction isMessagesPlaceholder(x) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return x.constructor.lc_name() === \"MessagesPlaceholder\";\n}\n/**\n * Class that represents a chat prompt. It extends the\n * BaseChatPromptTemplate and uses an array of BaseMessagePromptTemplate\n * instances to format a series of messages for a conversation.\n * @example\n * ```typescript\n * const message = SystemMessagePromptTemplate.fromTemplate(\"{text}\");\n * const chatPrompt = ChatPromptTemplate.fromMessages([\n *   [\"ai\", \"You are a helpful assistant.\"],\n *   message,\n * ]);\n * const formattedChatPrompt = await chatPrompt.invoke({\n *   text: \"Hello world!\",\n * });\n * ```\n */\nexport class ChatPromptTemplate extends BaseChatPromptTemplate {\n    static lc_name() {\n        return \"ChatPromptTemplate\";\n    }\n    get lc_aliases() {\n        return {\n            promptMessages: \"messages\",\n        };\n    }\n    constructor(input) {\n        super(input);\n        Object.defineProperty(this, \"promptMessages\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"validateTemplate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"templateFormat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"f-string\"\n        });\n        // If input is mustache and validateTemplate is not defined, set it to false\n        if (input.templateFormat === \"mustache\" &&\n            input.validateTemplate === undefined) {\n            this.validateTemplate = false;\n        }\n        Object.assign(this, input);\n        if (this.validateTemplate) {\n            const inputVariablesMessages = new Set();\n            for (const promptMessage of this.promptMessages) {\n                // eslint-disable-next-line no-instanceof/no-instanceof\n                if (promptMessage instanceof BaseMessage)\n                    continue;\n                for (const inputVariable of promptMessage.inputVariables) {\n                    inputVariablesMessages.add(inputVariable);\n                }\n            }\n            const totalInputVariables = this.inputVariables;\n            const inputVariablesInstance = new Set(this.partialVariables\n                ? totalInputVariables.concat(Object.keys(this.partialVariables))\n                : totalInputVariables);\n            const difference = new Set([...inputVariablesInstance].filter((x) => !inputVariablesMessages.has(x)));\n            if (difference.size > 0) {\n                throw new Error(`Input variables \\`${[\n                    ...difference,\n                ]}\\` are not used in any of the prompt messages.`);\n            }\n            const otherDifference = new Set([...inputVariablesMessages].filter((x) => !inputVariablesInstance.has(x)));\n            if (otherDifference.size > 0) {\n                throw new Error(`Input variables \\`${[\n                    ...otherDifference,\n                ]}\\` are used in prompt messages but not in the prompt template.`);\n            }\n        }\n    }\n    _getPromptType() {\n        return \"chat\";\n    }\n    async _parseImagePrompts(message, inputValues) {\n        if (typeof message.content === \"string\") {\n            return message;\n        }\n        const formattedMessageContent = await Promise.all(message.content.map(async (item) => {\n            if (item.type !== \"image_url\") {\n                return item;\n            }\n            let imageUrl = \"\";\n            if (typeof item.image_url === \"string\") {\n                imageUrl = item.image_url;\n            }\n            else {\n                imageUrl = item.image_url.url;\n            }\n            const promptTemplatePlaceholder = PromptTemplate.fromTemplate(imageUrl, {\n                templateFormat: this.templateFormat,\n            });\n            const formattedUrl = await promptTemplatePlaceholder.format(inputValues);\n            if (typeof item.image_url !== \"string\" && \"url\" in item.image_url) {\n                // eslint-disable-next-line no-param-reassign\n                item.image_url.url = formattedUrl;\n            }\n            else {\n                // eslint-disable-next-line no-param-reassign\n                item.image_url = formattedUrl;\n            }\n            return item;\n        }));\n        // eslint-disable-next-line no-param-reassign\n        message.content = formattedMessageContent;\n        return message;\n    }\n    async formatMessages(values) {\n        const allValues = await this.mergePartialAndUserVariables(values);\n        let resultMessages = [];\n        for (const promptMessage of this.promptMessages) {\n            // eslint-disable-next-line no-instanceof/no-instanceof\n            if (promptMessage instanceof BaseMessage) {\n                resultMessages.push(await this._parseImagePrompts(promptMessage, allValues));\n            }\n            else {\n                let inputValues;\n                if (this.templateFormat === \"mustache\") {\n                    inputValues = { ...allValues };\n                }\n                else {\n                    inputValues = promptMessage.inputVariables.reduce((acc, inputVariable) => {\n                        if (!(inputVariable in allValues) &&\n                            !(isMessagesPlaceholder(promptMessage) && promptMessage.optional)) {\n                            const error = addLangChainErrorFields(new Error(`Missing value for input variable \\`${inputVariable.toString()}\\``), \"INVALID_PROMPT_INPUT\");\n                            throw error;\n                        }\n                        acc[inputVariable] = allValues[inputVariable];\n                        return acc;\n                    }, {});\n                }\n                const message = await promptMessage.formatMessages(inputValues);\n                resultMessages = resultMessages.concat(message);\n            }\n        }\n        return resultMessages;\n    }\n    async partial(values) {\n        // This is implemented in a way it doesn't require making\n        // BaseMessagePromptTemplate aware of .partial()\n        const newInputVariables = this.inputVariables.filter((iv) => !(iv in values));\n        const newPartialVariables = {\n            ...(this.partialVariables ?? {}),\n            ...values,\n        };\n        const promptDict = {\n            ...this,\n            inputVariables: newInputVariables,\n            partialVariables: newPartialVariables,\n        };\n        return new ChatPromptTemplate(promptDict);\n    }\n    static fromTemplate(template, options) {\n        const prompt = PromptTemplate.fromTemplate(template, options);\n        const humanTemplate = new HumanMessagePromptTemplate({ prompt });\n        return this.fromMessages([humanTemplate]);\n    }\n    /**\n     * Create a chat model-specific prompt from individual chat messages\n     * or message-like tuples.\n     * @param promptMessages Messages to be passed to the chat model\n     * @returns A new ChatPromptTemplate\n     */\n    static fromMessages(promptMessages, extra) {\n        const flattenedMessages = promptMessages.reduce((acc, promptMessage) => acc.concat(\n        // eslint-disable-next-line no-instanceof/no-instanceof\n        promptMessage instanceof ChatPromptTemplate\n            ? promptMessage.promptMessages\n            : [\n                _coerceMessagePromptTemplateLike(promptMessage, extra),\n            ]), []);\n        const flattenedPartialVariables = promptMessages.reduce((acc, promptMessage) => \n        // eslint-disable-next-line no-instanceof/no-instanceof\n        promptMessage instanceof ChatPromptTemplate\n            ? Object.assign(acc, promptMessage.partialVariables)\n            : acc, Object.create(null));\n        const inputVariables = new Set();\n        for (const promptMessage of flattenedMessages) {\n            // eslint-disable-next-line no-instanceof/no-instanceof\n            if (promptMessage instanceof BaseMessage)\n                continue;\n            for (const inputVariable of promptMessage.inputVariables) {\n                if (inputVariable in flattenedPartialVariables) {\n                    continue;\n                }\n                inputVariables.add(inputVariable);\n            }\n        }\n        return new this({\n            ...extra,\n            inputVariables: [...inputVariables],\n            promptMessages: flattenedMessages,\n            partialVariables: flattenedPartialVariables,\n            templateFormat: extra?.templateFormat,\n        });\n    }\n    /** @deprecated Renamed to .fromMessages */\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    static fromPromptMessages(promptMessages) {\n        return this.fromMessages(promptMessages);\n    }\n}\n","import { ImagePromptValue } from \"../prompt_values.js\";\nimport { BasePromptTemplate, } from \"./base.js\";\nimport { checkValidTemplate, renderTemplate, } from \"./template.js\";\n/**\n * An image prompt template for a multimodal model.\n */\nexport class ImagePromptTemplate extends BasePromptTemplate {\n    static lc_name() {\n        return \"ImagePromptTemplate\";\n    }\n    constructor(input) {\n        super(input);\n        Object.defineProperty(this, \"lc_namespace\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: [\"langchain_core\", \"prompts\", \"image\"]\n        });\n        Object.defineProperty(this, \"template\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"templateFormat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"f-string\"\n        });\n        Object.defineProperty(this, \"validateTemplate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        /**\n         * Additional fields which should be included inside\n         * the message content array if using a complex message\n         * content.\n         */\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        Object.defineProperty(this, \"additionalContentFields\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.template = input.template;\n        this.templateFormat = input.templateFormat ?? this.templateFormat;\n        this.validateTemplate = input.validateTemplate ?? this.validateTemplate;\n        this.additionalContentFields = input.additionalContentFields;\n        if (this.validateTemplate) {\n            let totalInputVariables = this.inputVariables;\n            if (this.partialVariables) {\n                totalInputVariables = totalInputVariables.concat(Object.keys(this.partialVariables));\n            }\n            checkValidTemplate([\n                { type: \"image_url\", image_url: this.template },\n            ], this.templateFormat, totalInputVariables);\n        }\n    }\n    _getPromptType() {\n        return \"prompt\";\n    }\n    /**\n     * Partially applies values to the prompt template.\n     * @param values The values to be partially applied to the prompt template.\n     * @returns A new instance of ImagePromptTemplate with the partially applied values.\n     */\n    async partial(values) {\n        const newInputVariables = this.inputVariables.filter((iv) => !(iv in values));\n        const newPartialVariables = {\n            ...(this.partialVariables ?? {}),\n            ...values,\n        };\n        const promptDict = {\n            ...this,\n            inputVariables: newInputVariables,\n            partialVariables: newPartialVariables,\n        };\n        return new ImagePromptTemplate(promptDict);\n    }\n    /**\n     * Formats the prompt template with the provided values.\n     * @param values The values to be used to format the prompt template.\n     * @returns A promise that resolves to a string which is the formatted prompt.\n     */\n    async format(values) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const formatted = {};\n        for (const [key, value] of Object.entries(this.template)) {\n            if (typeof value === \"string\") {\n                formatted[key] = renderTemplate(value, this.templateFormat, values);\n            }\n            else {\n                formatted[key] = value;\n            }\n        }\n        const url = values.url || formatted.url;\n        const detail = values.detail || formatted.detail;\n        if (!url) {\n            throw new Error(\"Must provide either an image URL.\");\n        }\n        if (typeof url !== \"string\") {\n            throw new Error(\"url must be a string.\");\n        }\n        const output = { url };\n        if (detail) {\n            output.detail = detail;\n        }\n        return output;\n    }\n    /**\n     * Formats the prompt given the input values and returns a formatted\n     * prompt value.\n     * @param values The input values to format the prompt.\n     * @returns A Promise that resolves to a formatted prompt value.\n     */\n    async formatPromptValue(values) {\n        const formattedPrompt = await this.format(values);\n        return new ImagePromptValue(formattedPrompt);\n    }\n}\n","import { Runnable } from \"../runnables/base.js\";\nimport { parseTemplate, renderTemplate } from \"./template.js\";\nexport class DictPromptTemplate extends Runnable {\n    static lc_name() {\n        return \"DictPromptTemplate\";\n    }\n    constructor(fields) {\n        const templateFormat = fields.templateFormat ?? \"f-string\";\n        const inputVariables = _getInputVariables(fields.template, templateFormat);\n        super({ inputVariables, ...fields });\n        Object.defineProperty(this, \"lc_namespace\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: [\"langchain_core\", \"prompts\", \"dict\"]\n        });\n        Object.defineProperty(this, \"lc_serializable\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"template\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"templateFormat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"inputVariables\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.template = fields.template;\n        this.templateFormat = templateFormat;\n        this.inputVariables = inputVariables;\n    }\n    async format(values) {\n        return _insertInputVariables(this.template, values, this.templateFormat);\n    }\n    async invoke(values) {\n        return await this._callWithConfig(this.format.bind(this), values, {\n            runType: \"prompt\",\n        });\n    }\n}\nfunction _getInputVariables(template, templateFormat) {\n    const inputVariables = [];\n    for (const v of Object.values(template)) {\n        if (typeof v === \"string\") {\n            parseTemplate(v, templateFormat).forEach((t) => {\n                if (t.type === \"variable\") {\n                    inputVariables.push(t.name);\n                }\n            });\n        }\n        else if (Array.isArray(v)) {\n            for (const x of v) {\n                if (typeof x === \"string\") {\n                    parseTemplate(x, templateFormat).forEach((t) => {\n                        if (t.type === \"variable\") {\n                            inputVariables.push(t.name);\n                        }\n                    });\n                }\n                else if (typeof x === \"object\") {\n                    inputVariables.push(..._getInputVariables(x, templateFormat));\n                }\n            }\n        }\n        else if (typeof v === \"object\" && v !== null) {\n            inputVariables.push(..._getInputVariables(v, templateFormat));\n        }\n    }\n    return Array.from(new Set(inputVariables));\n}\nfunction _insertInputVariables(template, inputs, templateFormat) {\n    const formatted = {};\n    for (const [k, v] of Object.entries(template)) {\n        if (typeof v === \"string\") {\n            formatted[k] = renderTemplate(v, templateFormat, inputs);\n        }\n        else if (Array.isArray(v)) {\n            const formattedV = [];\n            for (const x of v) {\n                if (typeof x === \"string\") {\n                    formattedV.push(renderTemplate(x, templateFormat, inputs));\n                }\n                else if (typeof x === \"object\") {\n                    formattedV.push(_insertInputVariables(x, inputs, templateFormat));\n                }\n            }\n            formatted[k] = formattedV;\n        }\n        else if (typeof v === \"object\" && v !== null) {\n            formatted[k] = _insertInputVariables(v, inputs, templateFormat);\n        }\n        else {\n            formatted[k] = v;\n        }\n    }\n    return formatted;\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5]}