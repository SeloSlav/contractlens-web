{"version":3,"sources":["../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../../../apps/web/app/docs/%5BdocId%5D/chat/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","\"use client\";\n\nimport { useState, useRef, useEffect } from \"react\";\nimport Link from \"next/link\";\nimport { useParams } from \"next/navigation\";\n\nasync function sendMessage(\n  docId: string,\n  messages: { role: string; content: string }[]\n) {\n  const res = await fetch(\"/api/chat\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ docId, messages }),\n  });\n  if (!res.ok) {\n    const data = await res.json();\n    throw new Error(data.error ?? \"Chat failed\");\n  }\n  return res.json();\n}\n\nexport default function ChatPage() {\n  const params = useParams();\n  const docId = params?.docId as string | undefined;\n  const [messages, setMessages] = useState<{ role: string; content: string }[]>(\n    []\n  );\n  const [input, setInput] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [citations, setCitations] = useState<\n    { docId: string; chunkId: string; snippet: string }[]\n  >([]);\n  const bottomRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    if (!docId || !input.trim() || loading) return;\n\n    const userMsg = { role: \"user\", content: input.trim() };\n    setMessages((m) => [...m, userMsg]);\n    setInput(\"\");\n    setLoading(true);\n\n    try {\n      const { answer, citations: cits } = await sendMessage(docId, [\n        ...messages,\n        userMsg,\n      ]);\n      setMessages((m) => [...m, { role: \"assistant\", content: answer }]);\n      setCitations(cits ?? []);\n    } catch (err) {\n      setMessages((m) => [\n        ...m,\n        {\n          role: \"assistant\",\n          content: `Error: ${err instanceof Error ? err.message : \"Unknown error\"}`,\n        },\n      ]);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  if (!docId) return null;\n\n  return (\n    <div className=\"min-h-screen bg-zinc-50 dark:bg-black flex flex-col\">\n      <header className=\"border-b border-zinc-200 dark:border-zinc-800 p-4\">\n        <div className=\"max-w-3xl mx-auto flex items-center gap-4\">\n          <Link\n            href={`/docs/${docId}`}\n            className=\"text-zinc-600 dark:text-zinc-400 hover:underline\"\n          >\n            ‚Üê Back\n          </Link>\n          <h1 className=\"font-semibold\">Chat with Document</h1>\n        </div>\n      </header>\n\n      <main className=\"flex-1 overflow-y-auto p-4\">\n        <div className=\"max-w-3xl mx-auto space-y-4\">\n          {messages.length === 0 && (\n            <p className=\"text-zinc-500 dark:text-zinc-400 text-center py-12\">\n              Ask a question about this contract. Answers include citations.\n            </p>\n          )}\n          {messages.map((m, i) => (\n            <div\n              key={i}\n              className={`p-4 rounded-lg ${\n                m.role === \"user\"\n                  ? \"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 ml-8\"\n                  : \"bg-zinc-200 dark:bg-zinc-800 mr-8\"\n              }`}\n            >\n              <p className=\"whitespace-pre-wrap\">{m.content}</p>\n            </div>\n          ))}\n          {loading && (\n            <div className=\"flex gap-2 p-4 text-zinc-500\">\n              <span className=\"animate-pulse\">Thinking...</span>\n            </div>\n          )}\n          <div ref={bottomRef} />\n        </div>\n      </main>\n\n      {citations.length > 0 && (\n        <div className=\"border-t border-zinc-200 dark:border-zinc-800 p-4 bg-zinc-100 dark:bg-zinc-900/50\">\n          <div className=\"max-w-3xl mx-auto\">\n            <h3 className=\"text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2\">\n              Citations\n            </h3>\n            <div className=\"space-y-2 max-h-32 overflow-y-auto\">\n              {citations.map((c, i) => (\n                <div\n                  key={i}\n                  className=\"text-xs p-2 bg-white dark:bg-zinc-800 rounded border border-zinc-200 dark:border-zinc-700\"\n                >\n                  <span className=\"font-mono text-zinc-500\">{c.chunkId}</span>\n                  <p className=\"mt-1 text-zinc-600 dark:text-zinc-400 line-clamp-2\">\n                    {c.snippet}\n                  </p>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      <form onSubmit={handleSubmit} className=\"p-4 border-t border-zinc-200 dark:border-zinc-800\">\n        <div className=\"max-w-3xl mx-auto flex gap-2\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            placeholder=\"Ask about the contract...\"\n            className=\"flex-1 px-4 py-2 border border-zinc-300 dark:border-zinc-600 rounded-lg bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100\"\n            disabled={loading}\n          />\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"px-4 py-2 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 rounded-lg hover:opacity-90 disabled:opacity-50\"\n          >\n            Send\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","React","AppRouterContext","HooksClientContext","ServerInsertedHtml","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6]}